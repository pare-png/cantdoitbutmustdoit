"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _child_process = _interopRequireDefault(require("child_process"));

var _debug = _interopRequireDefault(require("debug"));

var _util = require("util");

var _username = _interopRequireDefault(require("username"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:determine-author');
const exec = (0, _util.promisify)(_child_process.default.exec);

const execAndTrimResult = async (command, dir) => {
  const {
    stdout
  } = await exec(command, {
    cwd: dir
  });
  return stdout.trim();
};

const getAuthorFromGitConfig = async dir => {
  try {
    const name = await execAndTrimResult('git config --get user.name', dir);
    const email = await execAndTrimResult('git config --get user.email', dir);
    return {
      name,
      email
    };
  } catch (err) {
    d('Error when getting git config:', err);
    return undefined;
  }
};

var _default = async dir => (await getAuthorFromGitConfig(dir)) || (0, _username.default)();

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2RldGVybWluZS1hdXRob3IudHMiXSwibmFtZXMiOlsiZCIsImV4ZWMiLCJjaGlsZFByb2Nlc3MiLCJleGVjQW5kVHJpbVJlc3VsdCIsImNvbW1hbmQiLCJkaXIiLCJzdGRvdXQiLCJjd2QiLCJ0cmltIiwiZ2V0QXV0aG9yRnJvbUdpdENvbmZpZyIsIm5hbWUiLCJlbWFpbCIsImVyciIsInVuZGVmaW5lZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFFQSxNQUFNQSxDQUFDLEdBQUcsb0JBQU0saUNBQU4sQ0FBVjtBQUNBLE1BQU1DLElBQUksR0FBRyxxQkFBVUMsdUJBQWFELElBQXZCLENBQWI7O0FBRUEsTUFBTUUsaUJBQWlCLEdBQUcsT0FBT0MsT0FBUCxFQUF3QkMsR0FBeEIsS0FBd0M7QUFDaEUsUUFBTTtBQUFFQyxJQUFBQTtBQUFGLE1BQWEsTUFBTUwsSUFBSSxDQUFDRyxPQUFELEVBQVU7QUFBRUcsSUFBQUEsR0FBRyxFQUFFRjtBQUFQLEdBQVYsQ0FBN0I7QUFDQSxTQUFPQyxNQUFNLENBQUNFLElBQVAsRUFBUDtBQUNELENBSEQ7O0FBS0EsTUFBTUMsc0JBQXNCLEdBQUcsTUFBT0osR0FBUCxJQUErQztBQUM1RSxNQUFJO0FBQ0YsVUFBTUssSUFBSSxHQUFHLE1BQU1QLGlCQUFpQixDQUFDLDRCQUFELEVBQStCRSxHQUEvQixDQUFwQztBQUNBLFVBQU1NLEtBQUssR0FBRyxNQUFNUixpQkFBaUIsQ0FBQyw2QkFBRCxFQUFnQ0UsR0FBaEMsQ0FBckM7QUFDQSxXQUFPO0FBQUVLLE1BQUFBLElBQUY7QUFBUUMsTUFBQUE7QUFBUixLQUFQO0FBQ0QsR0FKRCxDQUlFLE9BQU9DLEdBQVAsRUFBWTtBQUNaWixJQUFBQSxDQUFDLENBQUMsZ0NBQUQsRUFBbUNZLEdBQW5DLENBQUQ7QUFDQSxXQUFPQyxTQUFQO0FBQ0Q7QUFDRixDQVREOztlQVdlLE1BQU9SLEdBQVAsSUFBdUIsQ0FBQyxNQUFNSSxzQkFBc0IsQ0FBQ0osR0FBRCxDQUE3QixLQUF1Qyx3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuaW1wb3J0IHsgUGFja2FnZVBlcnNvbiB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9zaGFyZWQtdHlwZXMnO1xuaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgdXNlcm5hbWUgZnJvbSAndXNlcm5hbWUnO1xuXG5jb25zdCBkID0gZGVidWcoJ2VsZWN0cm9uLWZvcmdlOmRldGVybWluZS1hdXRob3InKTtcbmNvbnN0IGV4ZWMgPSBwcm9taXNpZnkoY2hpbGRQcm9jZXNzLmV4ZWMpO1xuXG5jb25zdCBleGVjQW5kVHJpbVJlc3VsdCA9IGFzeW5jIChjb21tYW5kOiBzdHJpbmcsIGRpcjogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjKGNvbW1hbmQsIHsgY3dkOiBkaXIgfSk7XG4gIHJldHVybiBzdGRvdXQudHJpbSgpO1xufTtcblxuY29uc3QgZ2V0QXV0aG9yRnJvbUdpdENvbmZpZyA9IGFzeW5jIChkaXI6IHN0cmluZyk6IFByb21pc2U8UGFja2FnZVBlcnNvbj4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG5hbWUgPSBhd2FpdCBleGVjQW5kVHJpbVJlc3VsdCgnZ2l0IGNvbmZpZyAtLWdldCB1c2VyLm5hbWUnLCBkaXIpO1xuICAgIGNvbnN0IGVtYWlsID0gYXdhaXQgZXhlY0FuZFRyaW1SZXN1bHQoJ2dpdCBjb25maWcgLS1nZXQgdXNlci5lbWFpbCcsIGRpcik7XG4gICAgcmV0dXJuIHsgbmFtZSwgZW1haWwgfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZCgnRXJyb3Igd2hlbiBnZXR0aW5nIGdpdCBjb25maWc6JywgZXJyKTtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAoZGlyOiBzdHJpbmcpID0+IChhd2FpdCBnZXRBdXRob3JGcm9tR2l0Q29uZmlnKGRpcikpIHx8IHVzZXJuYW1lKCk7XG4iXX0=