"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

require("colors");

var _asyncOra = require("@electron-forge/async-ora");

var _debug = _interopRequireDefault(require("debug"));

var _yarnOrNpm = require("../util/yarn-or-npm");

var _resolveDir = _interopRequireDefault(require("../util/resolve-dir"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:lint');

var _default = async ({
  dir = process.cwd(),
  interactive = false
}) => {
  _asyncOra.asyncOra.interactive = interactive;
  let success = true;
  let result = null;
  await (0, _asyncOra.asyncOra)('Linting Application', async lintSpinner => {
    const resolvedDir = await (0, _resolveDir.default)(dir);

    if (!resolvedDir) {
      throw new Error('Failed to locate lintable Electron application');
    }

    dir = resolvedDir;
    d('executing "run lint" in dir:', dir);

    try {
      await (0, _yarnOrNpm.yarnOrNpmSpawn)(['run', 'lint'], {
        stdio: process.platform === 'win32' ? 'inherit' : 'pipe',
        cwd: dir
      });
    } catch (err) {
      lintSpinner.fail();
      success = false;
      result = err;
    }
  });

  if (!success) {
    throw result;
  }
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvbGludC50cyJdLCJuYW1lcyI6WyJkIiwiZGlyIiwicHJvY2VzcyIsImN3ZCIsImludGVyYWN0aXZlIiwiYXN5bmNPcmEiLCJzdWNjZXNzIiwicmVzdWx0IiwibGludFNwaW5uZXIiLCJyZXNvbHZlZERpciIsIkVycm9yIiwic3RkaW8iLCJwbGF0Zm9ybSIsImVyciIsImZhaWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLHFCQUFOLENBQVY7O2VBT2UsT0FBTztBQUNwQkMsRUFBQUEsR0FBRyxHQUFHQyxPQUFPLENBQUNDLEdBQVIsRUFEYztBQUVwQkMsRUFBQUEsV0FBVyxHQUFHO0FBRk0sQ0FBUCxLQUdJO0FBQ2pCQyxxQkFBU0QsV0FBVCxHQUF1QkEsV0FBdkI7QUFFQSxNQUFJRSxPQUFPLEdBQUcsSUFBZDtBQUNBLE1BQUlDLE1BQU0sR0FBRyxJQUFiO0FBRUEsUUFBTSx3QkFBUyxxQkFBVCxFQUFnQyxNQUFPQyxXQUFQLElBQXVCO0FBQzNELFVBQU1DLFdBQVcsR0FBRyxNQUFNLHlCQUFXUixHQUFYLENBQTFCOztBQUNBLFFBQUksQ0FBQ1EsV0FBTCxFQUFrQjtBQUNoQixZQUFNLElBQUlDLEtBQUosQ0FBVSxnREFBVixDQUFOO0FBQ0Q7O0FBRURULElBQUFBLEdBQUcsR0FBR1EsV0FBTjtBQUVBVCxJQUFBQSxDQUFDLENBQUMsOEJBQUQsRUFBaUNDLEdBQWpDLENBQUQ7O0FBQ0EsUUFBSTtBQUNGLFlBQU0sK0JBQWUsQ0FBQyxLQUFELEVBQVEsTUFBUixDQUFmLEVBQWdDO0FBQ3BDVSxRQUFBQSxLQUFLLEVBQUVULE9BQU8sQ0FBQ1UsUUFBUixLQUFxQixPQUFyQixHQUErQixTQUEvQixHQUEyQyxNQURkO0FBRXBDVCxRQUFBQSxHQUFHLEVBQUVGO0FBRitCLE9BQWhDLENBQU47QUFJRCxLQUxELENBS0UsT0FBT1ksR0FBUCxFQUFZO0FBQ1pMLE1BQUFBLFdBQVcsQ0FBQ00sSUFBWjtBQUNBUixNQUFBQSxPQUFPLEdBQUcsS0FBVjtBQUNBQyxNQUFBQSxNQUFNLEdBQUdNLEdBQVQ7QUFDRDtBQUNGLEdBbkJLLENBQU47O0FBcUJBLE1BQUksQ0FBQ1AsT0FBTCxFQUFjO0FBQ1osVUFBTUMsTUFBTjtBQUNEO0FBQ0YsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnY29sb3JzJztcbmltcG9ydCB7IGFzeW5jT3JhIH0gZnJvbSAnQGVsZWN0cm9uLWZvcmdlL2FzeW5jLW9yYSc7XG5pbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuaW1wb3J0IHsgeWFybk9yTnBtU3Bhd24gfSBmcm9tICcuLi91dGlsL3lhcm4tb3ItbnBtJztcblxuaW1wb3J0IHJlc29sdmVEaXIgZnJvbSAnLi4vdXRpbC9yZXNvbHZlLWRpcic7XG5cbmNvbnN0IGQgPSBkZWJ1ZygnZWxlY3Ryb24tZm9yZ2U6bGludCcpO1xuXG5leHBvcnQgaW50ZXJmYWNlIExpbnRPcHRpb25zIHtcbiAgZGlyPzogc3RyaW5nO1xuICBpbnRlcmFjdGl2ZT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jICh7XG4gIGRpciA9IHByb2Nlc3MuY3dkKCksXG4gIGludGVyYWN0aXZlID0gZmFsc2UsXG59OiBMaW50T3B0aW9ucykgPT4ge1xuICBhc3luY09yYS5pbnRlcmFjdGl2ZSA9IGludGVyYWN0aXZlO1xuXG4gIGxldCBzdWNjZXNzID0gdHJ1ZTtcbiAgbGV0IHJlc3VsdCA9IG51bGw7XG5cbiAgYXdhaXQgYXN5bmNPcmEoJ0xpbnRpbmcgQXBwbGljYXRpb24nLCBhc3luYyAobGludFNwaW5uZXIpID0+IHtcbiAgICBjb25zdCByZXNvbHZlZERpciA9IGF3YWl0IHJlc29sdmVEaXIoZGlyKTtcbiAgICBpZiAoIXJlc29sdmVkRGlyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBsb2NhdGUgbGludGFibGUgRWxlY3Ryb24gYXBwbGljYXRpb24nKTtcbiAgICB9XG5cbiAgICBkaXIgPSByZXNvbHZlZERpcjtcblxuICAgIGQoJ2V4ZWN1dGluZyBcInJ1biBsaW50XCIgaW4gZGlyOicsIGRpcik7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHlhcm5Pck5wbVNwYXduKFsncnVuJywgJ2xpbnQnXSwge1xuICAgICAgICBzdGRpbzogcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJyA/ICdpbmhlcml0JyA6ICdwaXBlJyxcbiAgICAgICAgY3dkOiBkaXIsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxpbnRTcGlubmVyLmZhaWwoKTtcbiAgICAgIHN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgIHJlc3VsdCA9IGVycjtcbiAgICB9XG4gIH0pO1xuXG4gIGlmICghc3VjY2Vzcykge1xuICAgIHRocm93IHJlc3VsdDtcbiAgfVxufTtcbiJdfQ==