"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _asyncOra = require("@electron-forge/async-ora");

var _child_process = require("child_process");

var _debug = _interopRequireDefault(require("debug"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:init:git');

var _default = async dir => {
  await (0, _asyncOra.asyncOra)('Initializing Git Repository', async () => {
    await new Promise((resolve, reject) => {
      (0, _child_process.exec)('git rev-parse --show-toplevel', {
        cwd: dir
      }, err => {
        if (err) {
          // not run within a Git repository
          d('executing "git init" in directory:', dir);
          (0, _child_process.exec)('git init', {
            cwd: dir
          }, initErr => initErr ? reject(initErr) : resolve());
        } else {
          d('.git directory already exists, skipping git initialization');
          resolve();
        }
      });
    });
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvaW5pdC1zY3JpcHRzL2luaXQtZ2l0LnRzIl0sIm5hbWVzIjpbImQiLCJkaXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImN3ZCIsImVyciIsImluaXRFcnIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLHlCQUFOLENBQVY7O2VBRWUsTUFBT0MsR0FBUCxJQUF1QjtBQUNwQyxRQUFNLHdCQUFTLDZCQUFULEVBQXdDLFlBQVk7QUFDeEQsVUFBTSxJQUFJQyxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3JDLCtCQUFLLCtCQUFMLEVBQXNDO0FBQ3BDQyxRQUFBQSxHQUFHLEVBQUVKO0FBRCtCLE9BQXRDLEVBRUlLLEdBQUQsSUFBUztBQUNWLFlBQUlBLEdBQUosRUFBUztBQUNQO0FBQ0FOLFVBQUFBLENBQUMsQ0FBQyxvQ0FBRCxFQUF1Q0MsR0FBdkMsQ0FBRDtBQUNBLG1DQUFLLFVBQUwsRUFBaUI7QUFBRUksWUFBQUEsR0FBRyxFQUFFSjtBQUFQLFdBQWpCLEVBQWdDTSxPQUFELElBQWNBLE9BQU8sR0FBR0gsTUFBTSxDQUFDRyxPQUFELENBQVQsR0FBcUJKLE9BQU8sRUFBaEY7QUFDRCxTQUpELE1BSU87QUFDTEgsVUFBQUEsQ0FBQyxDQUFDLDREQUFELENBQUQ7QUFDQUcsVUFBQUEsT0FBTztBQUNSO0FBQ0YsT0FYRDtBQVlELEtBYkssQ0FBTjtBQWNELEdBZkssQ0FBTjtBQWdCRCxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXN5bmNPcmEgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvYXN5bmMtb3JhJztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5cbmNvbnN0IGQgPSBkZWJ1ZygnZWxlY3Ryb24tZm9yZ2U6aW5pdDpnaXQnKTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGRpcjogc3RyaW5nKSA9PiB7XG4gIGF3YWl0IGFzeW5jT3JhKCdJbml0aWFsaXppbmcgR2l0IFJlcG9zaXRvcnknLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZXhlYygnZ2l0IHJldi1wYXJzZSAtLXNob3ctdG9wbGV2ZWwnLCB7XG4gICAgICAgIGN3ZDogZGlyLFxuICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgLy8gbm90IHJ1biB3aXRoaW4gYSBHaXQgcmVwb3NpdG9yeVxuICAgICAgICAgIGQoJ2V4ZWN1dGluZyBcImdpdCBpbml0XCIgaW4gZGlyZWN0b3J5OicsIGRpcik7XG4gICAgICAgICAgZXhlYygnZ2l0IGluaXQnLCB7IGN3ZDogZGlyIH0sIChpbml0RXJyKSA9PiAoaW5pdEVyciA/IHJlamVjdChpbml0RXJyKSA6IHJlc29sdmUoKSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGQoJy5naXQgZGlyZWN0b3J5IGFscmVhZHkgZXhpc3RzLCBza2lwcGluZyBnaXQgaW5pdGlhbGl6YXRpb24nKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn07XG4iXX0=